<div class="product-detail" *ngIf="product()">
  <div class="container">
    <!-- Breadcrumbs -->
    <nav class="breadcrumbs">
      <a routerLink="/" class="breadcrumb-link">Home</a>
      <span class="breadcrumb-separator">/</span>
      <a routerLink="/shop" class="breadcrumb-link">Shop</a>
      <span class="breadcrumb-separator">/</span>
      <a [routerLink]="getCategoryRoute()" class="breadcrumb-link">{{ getCategoryDisplayName() }}</a>
      <span class="breadcrumb-separator">/</span>
      <span class="breadcrumb-current">{{ product()!.name }}</span>
    </nav>

    <div class="product-content">
      <!-- Product Images -->
      <div class="product-images">
        <div class="main-image">
          <img [src]="selectedImage()" [alt]="product()!.name" class="main-img">
          
          <!-- Slider Controls -->
          <div class="slider-controls" *ngIf="getCurrentImages().length > 1">
            <button 
              class="slider-btn prev-btn" 
              (click)="goToPreviousImage()"
              [attr.aria-label]="'Previous image'">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="15,18 9,12 15,6"></polyline>
              </svg>
            </button>
            <button 
              class="slider-btn next-btn" 
              (click)="goToNextImage()"
              [attr.aria-label]="'Next image'">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="9,6 15,12 9,18"></polyline>
              </svg>
            </button>
          </div>

          <!-- Slider Dots -->
          <div class="slider-dots" *ngIf="getCurrentImages().length > 1">
            <button 
              *ngFor="let image of getCurrentImages(); let i = index"
              [class.active]="i === currentImageIndex()"
              (click)="goToImage(i)"
              class="dot-btn"
              [attr.aria-label]="'Go to image ' + (i + 1)">
              <span class="dot"></span>
            </button>
          </div>
        </div>
        
        <div class="thumbnail-images" *ngIf="getCurrentImages().length > 1">
          <button 
            *ngFor="let image of getCurrentImages(); let i = index" 
            (click)="selectImage(image)"
            [class.active]="selectedImage() === image"
            class="thumbnail-btn">
            <img [src]="image" [alt]="product()!.name" class="thumbnail-img">
          </button>
        </div>
      </div>

      <!-- Product Info -->
      <div class="product-info">
        <h1 class="product-name">{{ getProductDisplayName() }}</h1>
        
        <div class="product-price">
          <span class="price" [class.sale]="product()!.originalPrice">
            {{ currencyService.getSymbol() }}{{ getDisplayPrice(product()!) }}
          </span>
          <span *ngIf="product()!.originalPrice" class="original-price">
            {{ currencyService.getSymbol() }}{{ getDisplayOriginalPrice(product()!) }}
          </span>
        </div>

        <!-- Size Selection -->
        <div class="size-selection" *ngIf="product()!.sizes.length > 0">
          <h3>Size</h3>
          <div class="size-options">
            <button 
              *ngFor="let size of product()!.sizes"
              [class.selected]="selectedSize() === size"
              (click)="selectSize(size)"
              class="size-btn">
              {{ size }}
            </button>
          </div>
        </div>

        <!-- Color Selection -->
        <div class="color-selection" *ngIf="product()!.colors.length > 0">
          <h3>{{ selectedColor() }}</h3>
          <div class="color-options">
            <button 
              *ngFor="let color of product()!.colors"
              [class.selected]="selectedColor() === color"
              (click)="selectColor(color)"
              class="color-btn"
              [title]="color">
              <div class="color-preview">
                <img [src]="getColorPreviewImage(color)" [alt]="color" class="color-image">
              </div>
            </button>
          </div>
        </div>

        <!-- Add to Cart -->
        <div class="add-to-cart">
          <button 
            [disabled]="!product()!.inStock"
            (click)="addToCart()"
            class="add-to-cart-btn">
            {{ product()!.inStock ? 'ADD TO BAG' : 'SOLD OUT' }}
          </button>
        </div>

        <!-- Product Details -->
        <!-- <div class="product-details">
          <div class="detail-item">
            <strong>Availability:</strong> 
            <span [class]="product()!.inStock ? 'in-stock' : 'out-of-stock'">
              {{ product()!.inStock ? 'In Stock' : 'Out of Stock' }}
            </span>
          </div>
        </div> -->
      </div>
    </div>
  </div>
</div>

<!-- Loading State -->
<div *ngIf="!product()" class="loading">
  <div class="loading-spinner"></div>
</div>
